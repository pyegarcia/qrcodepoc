<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets Data Retrieval</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    $(document).ready(function() {
      // Get the value from the URL parameter
      const searchValue = getUrlParameter('search');

      if (!searchValue) {
        console.error('Search value not found in URL.');
      } else {
        // Replace 'SPREADSHEET_ID' with the actual ID of your Google Sheets spreadsheet
        const spreadsheetId = '2PACX-1vSfpwcLvyT__6Yt2ct758LUEZ8yh96zm8Q1Bsv4lfSRI2nTLp6BbxhK9cftS8YHggHsRLnKGZVHgMKe';
        // Replace 'SHEET_NAME' with the name of the sheet containing the data
        const sheetName = 'SHEET1';

        const url = `https://spreadsheets.google.com/feeds/cells/${spreadsheetId}/1/public/values?alt=json-in-script&callback=?`;

        $.getJSON(url, function(data) {
          const entries = data.feed.entry;

          let cellValue = '';
          for (let i = 0; i < entries.length; i++) {
            if (entries[i].content.$t === searchValue) {
              // The matching cell is one column to the right (assuming a 2-column structure)
              cellValue = entries[i + 1].content.$t;
              break;
            }
          }

          if (cellValue) {
            // Perform actions with the retrieved cell value, such as updating HTML elements
            document.getElementById('cellValue').textContent = cellValue;
          } else {
            console.log('No matching cell value found.');
          }
        });
      }
    });

    // Function to get the URL parameter value
    function getUrlParameter(name) {
      name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
      const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
      const results = regex.exec(location.search);
      return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }
  </script>
</head>
<body>
  <h1>Cell Value:</h1>
  <p id="cellValue"></p>
</body>
</html>
